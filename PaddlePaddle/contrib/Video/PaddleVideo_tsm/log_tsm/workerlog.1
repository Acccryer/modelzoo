I0214 13:37:10.964186 2137168 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:37:10.964267 2137168 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:37:11.063570 2137168 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:37:11.066323 2137168 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:37:11.066462 2137168 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:37:11.066485 2137168 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:37:12.309772 2137168 tcp_utils.cc:107] Retry to connect to 172.17.0.3:44203 while the server is not yet listening.
I0214 13:37:15.310057 2137168 tcp_utils.cc:130] Successfully connected to 172.17.0.3:44203
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 159, in train_model
    train_dataset = build_dataset((cfg.DATASET.train, cfg.PIPELINE.train))
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/loader/builder.py", line 50, in build_dataset
    dataset = build(cfg_dataset, DATASETS, key="format")
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/utils/build_utils.py", line 35, in build
    return obj_cls(**cfg_copy)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/loader/dataset/frame.py", line 58, in __init__
    super().__init__(file_path, pipeline, data_prefix, test_mode)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/loader/dataset/base.py", line 49, in __init__
    self.info = self.load_file()
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/loader/dataset/frame.py", line 63, in load_file
    with open(self.file_path, 'r') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'data/k400_frames/train.list'
I0214 13:43:21.202795 2139763 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:43:21.202844 2139763 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:43:21.308564 2139763 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:43:21.311021 2139763 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:43:21.311136 2139763 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:43:21.311157 2139763 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:43:22.114209 2139763 tcp_utils.cc:130] Successfully connected to 172.17.0.3:39545
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 241, in train_model
    model = paddle.DataParallel(model)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 398, in __init__
    sync_params_buffers(self._layers, fuse_params=False)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/dygraph/base.py", line 340, in __impl__
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/wrapped_decorator.py", line 26, in __impl__
    return wrapped_func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/framework.py", line 593, in __impl__
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 197, in sync_params_buffers
    paddle.distributed.broadcast(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/broadcast.py", line 64, in broadcast
    return stream.broadcast(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/stream/broadcast.py", line 124, in broadcast
    return _broadcast_in_dygraph(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/stream/broadcast.py", line 32, in _broadcast_in_dygraph
    task = group.process_group.broadcast(tensor, src_rank_in_group, sync_op)
ValueError: (InvalidArgument) TCP receive error. Details: Success.
  [Hint: Expected byte_received > 0, but received byte_received:0 <= 0:0.] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/distributed/store/tcp_utils.h:107)

I0214 13:45:40.447912 2140975 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:45:40.447960 2140975 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:45:40.531445 2140975 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:45:40.533907 2140975 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:45:40.534008 2140975 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:45:40.534030 2140975 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:45:41.452164 2140975 tcp_utils.cc:130] Successfully connected to 172.17.0.3:51931
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 241, in train_model
    model = paddle.DataParallel(model)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 398, in __init__
    sync_params_buffers(self._layers, fuse_params=False)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/dygraph/base.py", line 340, in __impl__
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/wrapped_decorator.py", line 26, in __impl__
    return wrapped_func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/base/framework.py", line 593, in __impl__
    return func(*args, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 197, in sync_params_buffers
    paddle.distributed.broadcast(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/broadcast.py", line 64, in broadcast
    return stream.broadcast(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/stream/broadcast.py", line 124, in broadcast
    return _broadcast_in_dygraph(
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/communication/stream/broadcast.py", line 32, in _broadcast_in_dygraph
    task = group.process_group.broadcast(tensor, src_rank_in_group, sync_op)
ValueError: (InvalidArgument) TCP receive error. Details: Success.
  [Hint: Expected byte_received > 0, but received byte_received:0 <= 0:0.] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/distributed/store/tcp_utils.h:107)

I0214 13:47:09.437521 2141891 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:47:09.437604 2141891 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:47:09.546175 2141891 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:47:09.549489 2141891 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:47:09.549635 2141891 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:47:09.549664 2141891 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:47:10.508168 2141891 tcp_utils.cc:107] Retry to connect to 172.17.0.3:35713 while the server is not yet listening.
I0214 13:47:13.508514 2141891 tcp_utils.cc:130] Successfully connected to 172.17.0.3:35713
=======: data/ResNet50_pretrain.pdparams
I0214 13:49:12.275604 2143030 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:49:12.275677 2143030 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:49:12.378592 2143030 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:49:12.381203 2143030 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:49:12.381338 2143030 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:49:12.381371 2143030 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:49:13.291149 2143030 tcp_utils.cc:130] Successfully connected to 172.17.0.3:36504
Exception in thread Thread-1 (_thread_loop):
Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    batch = self._get_data()
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 751, in _get_data
    batch.reraise()
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 259, in train_model
    for i, data in enumerate(train_loader):
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 825, in __next__
    self._reader.read_next_list()[0]
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/fluid/operators/reader/blocking_queue.h:175)

    raise self.exc_type(msg)
TypeError: DataLoader worker(1) caught TypeError with message:
Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/fetcher.py", line 85, in fetch
    data = self.collate_fn(data)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/collate.py", line 77, in default_collate_fn
    raise TypeError(
TypeError: batch data con only contains: tensor, numpy.ndarray, dict, list, number, but got <class 'NoneType'>

I0214 13:57:03.263939 2147410 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 13:57:03.264025 2147410 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 13:57:03.348459 2147410 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 13:57:03.351042 2147410 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 13:57:03.351156 2147410 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 13:57:03.351178 2147410 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 13:57:04.267455 2147410 tcp_utils.cc:130] Successfully connected to 172.17.0.3:35615
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 353, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 157, in forward
    shifts = F.temporal_shift(inputs,
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/functional/extension.py", line 300, in temporal_shift
    return _C_ops.temporal_shift(x, seg_num, shift_ratio, data_format)
RuntimeError: (NotFound) The kernel with key (sdaa, Undefined(AnyLayout), float16) of kernel `temporal_shift` is not registered and fail to fallback to CPU one. Selected wrong Backend `sdaa`. Paddle support following Backends: CPU.
  [Hint: Expected kernel_iter != iter->second.end(), but received kernel_iter == iter->second.end().] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/kernel_factory.cc:333)

I0214 14:06:17.613689 2152986 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:06:17.613725 2152986 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:06:17.689996 2152986 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:06:17.691967 2152986 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:06:17.692047 2152986 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:06:17.692063 2152986 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:06:18.413218 2152986 tcp_utils.cc:107] Retry to connect to 172.17.0.3:60345 while the server is not yet listening.
I0214 14:06:21.413450 2152986 tcp_utils.cc:130] Successfully connected to 172.17.0.3:60345
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 353, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 157, in forward
    shifts = F.temporal_shift(inputs,
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/functional/extension.py", line 300, in temporal_shift
    return _C_ops.temporal_shift(x, seg_num, shift_ratio, data_format)
RuntimeError: (NotFound) The kernel with key (sdaa, Undefined(AnyLayout), float16) of kernel `temporal_shift` is not registered and fail to fallback to CPU one. Selected wrong Backend `sdaa`. Paddle support following Backends: CPU.
  [Hint: Expected kernel_iter != iter->second.end(), but received kernel_iter == iter->second.end().] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/kernel_factory.cc:333)

W0214 14:06:28.320539 2154502 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
W0214 14:06:28.320667 2154502 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
I0214 14:07:26.751924 2155222 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:07:26.751991 2155222 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:07:26.839821 2155222 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:07:26.842195 2155222 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:07:26.842293 2155222 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:07:26.842317 2155222 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:07:27.557952 2155222 tcp_utils.cc:107] Retry to connect to 172.17.0.3:42459 while the server is not yet listening.
I0214 14:07:30.558178 2155222 tcp_utils.cc:130] Successfully connected to 172.17.0.3:42459
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 353, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 157, in forward
    shifts = F.temporal_shift(inputs,
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/functional/extension.py", line 300, in temporal_shift
    return _C_ops.temporal_shift(x, seg_num, shift_ratio, data_format)
RuntimeError: (NotFound) The kernel with key (sdaa, Undefined(AnyLayout), float16) of kernel `temporal_shift` is not registered and fail to fallback to CPU one. Selected wrong Backend `sdaa`. Paddle support following Backends: CPU.
  [Hint: Expected kernel_iter != iter->second.end(), but received kernel_iter == iter->second.end().] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/kernel_factory.cc:333)

W0214 14:07:37.356148 2156709 device_manager.cc:92] [RecordEvent]raw event or raw stream is null, skip RecordEvent!
W0214 14:07:37.356217 2156709 device_manager.cc:113] [StreamWaitEvent]raw event or raw stream is null, skip StreamWaitEvent!
W0214 14:07:37.364997 2156709 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
W0214 14:07:37.388206 2156709 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
I0214 14:10:33.139456 2158002 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:10:33.139506 2158002 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:10:33.219446 2158002 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:10:33.221616 2158002 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:10:33.221705 2158002 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:10:33.221725 2158002 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:10:33.931216 2158002 tcp_utils.cc:130] Successfully connected to 172.17.0.3:57768
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 355, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 157, in forward
    print("=======inputs",inputs.device.type)
AttributeError: 'Tensor' object has no attribute 'device'. Did you mean: 'divide'?
W0214 14:10:43.836792 2159468 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
W0214 14:10:43.836903 2159468 device_manager.cc:59] [SynchronizeStream]raw stream is null, skip synchronize!
I0214 14:11:09.862118 2159793 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:11:09.862171 2159793 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:11:09.964955 2159793 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:11:09.967476 2159793 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:11:09.967598 2159793 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:11:09.967626 2159793 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:11:10.897683 2159793 tcp_utils.cc:130] Successfully connected to 172.17.0.3:47474
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
=======inputs Tensor(shape=[128, 64, 56, 56], dtype=float16, place=Place(sdaa:1), stop_gradient=False,
       [[[[0.26464844, 0.03659058, 0.06015015, ..., 0.80126953,
           0.58105469, 1.79394531],
          [0.36499023, 0.14392090, 0.14904785, ..., 0.65966797,
           0.31738281, 1.87695312],
          [0.35229492, 0.14562988, 0.16967773, ..., 0.65966797,
           0.50439453, 2.01367188],
          ...,
          [0.38891602, 0.08422852, 0.08984375, ..., 0.17565918,
           0.17565918, 0.23645020],
          [0.66796875, 0.09124756, 0.10491943, ..., 0.17565918,
           0.17565918, 0.20666504],
          [1.20996094, 0.85205078, 0.13049316, ..., 0.22106934,
           0.24328613, 0.24438477]],

         [[1.34667969, 1.39257812, 1.48144531, ..., 0.        ,
           0.        , 0.03912354],
          [0.27270508, 0.34301758, 0.34082031, ..., 0.11285400,
           0.07635498, 0.12017822],
          [0.16174316, 0.26025391, 0.28198242, ..., 0.11285400,
           0.11926270, 0.12017822],
          ...,
          [0.20874023, 0.22497559, 0.22497559, ..., 0.17956543,
           0.17358398, 0.20117188],
          [0.31518555, 0.26782227, 0.21215820, ..., 0.27197266,
           0.38232422, 0.40380859],
          [0.47485352, 1.39941406, 1.44433594, ..., 1.08398438,
           1.07421875, 1.09667969]],

         [[0.        , 0.        , 0.        , ..., 0.64746094,
           0.46337891, 0.47094727],
          [0.        , 0.        , 0.        , ..., 0.60791016,
           0.36132812, 0.41040039],
          [0.        , 0.        , 0.        , ..., 0.63525391,
           0.44067383, 0.46044922],
          ...,
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ]],

         ...,

         [[0.00256157, 0.        , 0.        , ..., 1.46484375,
           1.22851562, 1.21777344],
          [0.14672852, 0.10644531, 0.09393311, ..., 0.28344727,
           0.18505859, 0.22961426],
          [0.17224121, 0.19677734, 0.19763184, ..., 0.30102539,
           0.33642578, 0.23657227],
          ...,
          [0.20483398, 0.14526367, 0.05184937, ..., 0.08520508,
           0.04495239, 0.02388000],
          [0.44604492, 0.27490234, 0.07366943, ..., 0.02397156,
           0.        , 0.00244141],
          [0.86718750, 0.86718750, 0.82275391, ..., 0.95800781,
           0.94677734, 0.95019531]],

         [[0.46215820, 0.51953125, 0.51806641, ..., 0.31689453,
           0.15771484, 0.11016846],
          [0.46215820, 0.51953125, 0.51806641, ..., 0.31689453,
           0.26489258, 0.14990234],
          [0.36328125, 0.40673828, 0.42675781, ..., 0.26489258,
           0.28881836, 0.17883301],
          ...,
          [0.37353516, 0.39331055, 0.39331055, ..., 0.37109375,
           0.36914062, 0.36840820],
          [0.37353516, 0.42553711, 0.41162109, ..., 0.37817383,
           0.34179688, 0.35156250],
          [0.54345703, 0.57177734, 0.55908203, ..., 0.59179688,
           0.59179688, 0.58056641]],

         [[1.27734375, 1.24023438, 1.19726562, ..., 0.19750977,
           0.19750977, 0.61376953],
          [0.63134766, 0.22326660, 0.17004395, ..., 0.32470703,
           0.30200195, 0.61376953],
          [0.43432617, 0.10510254, 0.12493896, ..., 0.28564453,
           0.17968750, 0.54492188],
          ...,
          [0.61523438, 0.17724609, 0.20617676, ..., 0.28515625,
           0.28515625, 0.23950195],
          [0.39208984, 0.09942627, 0.12695312, ..., 0.45874023,
           0.35522461, 0.31005859],
          [0.11529541, 0.09942627, 0.09558105, ..., 0.45874023,
           0.34399414, 0.30322266]]],


        [[[0.20739746, 0.10107422, 0.10107422, ..., 0.51171875,
           0.52734375, 1.69921875],
          [0.24243164, 0.12536621, 0.12536621, ..., 0.30517578,
           0.28613281, 1.83789062],
          [0.22546387, 0.13891602, 0.13891602, ..., 0.26245117,
           0.28613281, 1.83789062],
          ...,
          [0.45825195, 0.58300781, 0.58300781, ..., 0.59472656,
           0.25634766, 0.22155762],
          [0.45825195, 0.55761719, 0.52929688, ..., 0.34497070,
           0.34497070, 0.14611816],
          [0.64843750, 0.17333984, 0.19628906, ..., 0.33764648,
           0.33764648, 0.28955078]],

         [[0.29150391, 0.31445312, 0.32690430, ..., 0.07092285,
           0.04803467, 0.12249756],
          [0.14624023, 0.16394043, 0.16235352, ..., 0.07092285,
           0.08734131, 0.13159180],
          [0.13488770, 0.15246582, 0.15246582, ..., 0.08642578,
           0.05313110, 0.14147949],
          ...,
          [0.04168701, 0.75048828, 0.92529297, ..., 0.38964844,
           0.25805664, 0.20825195],
          [0.98828125, 0.86718750, 0.75048828, ..., 0.28710938,
           0.31274414, 0.26586914],
          [1.35253906, 1.44433594, 1.43554688, ..., 1.67187500,
           1.67187500, 1.49218750]],

         [[0.        , 0.        , 0.        , ..., 0.37597656,
           0.37597656, 0.46459961],
          [0.        , 0.        , 0.        , ..., 0.22961426,
           0.32690430, 0.43017578],
          [0.        , 0.        , 0.        , ..., 0.25512695,
           0.35034180, 0.43017578],
          ...,
          [0.15783691, 0.13195801, 0.13195801, ..., 0.        ,
           0.        , 0.        ],
          [0.15783691, 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ]],

         ...,

         [[0.32812500, 0.32983398, 0.33203125, ..., 1.05761719,
           1.07324219, 1.05859375],
          [0.06518555, 0.05911255, 0.04638672, ..., 0.10229492,
           0.17492676, 0.24426270],
          [0.        , 0.        , 0.        , ..., 0.11889648,
           0.17492676, 0.20129395],
          ...,
          [0.        , 0.        , 0.01363373, ..., 0.14404297,
           0.08813477, 0.07592773],
          [0.        , 0.        , 0.02734375, ..., 0.14404297,
           0.18029785, 0.09643555],
          [0.89501953, 0.90087891, 0.90478516, ..., 0.82031250,
           0.75878906, 0.86865234]],

         [[0.22338867, 0.21875000, 0.21569824, ..., 0.12060547,
           0.13269043, 0.14929199],
          [0.22180176, 0.23815918, 0.24499512, ..., 0.12792969,
           0.13879395, 0.21118164],
          [0.30297852, 0.30297852, 0.23815918, ..., 0.15478516,
           0.12792969, 0.17785645],
          ...,
          [0.19677734, 0.55078125, 0.71728516, ..., 0.44702148,
           0.43334961, 0.38500977],
          [0.50244141, 0.57861328, 0.62353516, ..., 0.44018555,
           0.50537109, 0.38403320],
          [0.47631836, 0.62500000, 0.61621094, ..., 0.60205078,
           0.57080078, 0.56689453]],

         [[0.21289062, 0.18017578, 0.17932129, ..., 0.24780273,
           0.20935059, 0.54394531],
          [0.29003906, 0.21630859, 0.25708008, ..., 0.24780273,
           0.20935059, 0.54394531],
          [0.41528320, 0.55761719, 0.64697266, ..., 0.16577148,
           0.21691895, 0.59960938],
          ...,
          [2.09179688, 2.14453125, 2.14453125, ..., 0.53662109,
           0.21899414, 0.16857910],
          [2.09179688, 2.09179688, 1.02929688, ..., 0.29296875,
           0.17321777, 0.13244629],
          [0.82226562, 0.26245117, 0.26635742, ..., 0.30224609,
           0.30224609, 0.18115234]]],


        [[[0.10418701, 0.11834717, 0.14697266, ..., 0.57666016,
           0.57666016, 1.96484375],
          [0.17407227, 0.14709473, 0.17504883, ..., 0.31884766,
           0.35302734, 2.01562500],
          [0.21020508, 0.15820312, 0.29296875, ..., 0.40014648,
           0.38940430, 2.03906250],
          ...,
          [0.22265625, 0.25878906, 0.84277344, ..., 0.15368652,
           0.19702148, 1.08984375],
          [0.15441895, 0.20227051, 0.39990234, ..., 0.26684570,
           0.55664062, 0.90673828],
          [0.17663574, 0.17663574, 0.34423828, ..., 1.04589844,
           1.04589844, 0.46118164]],

         [[0.64550781, 0.64550781, 0.70556641, ..., 0.01637268,
           0.        , 0.00026894],
          [0.15539551, 0.18286133, 0.15917969, ..., 0.29711914,
           0.29711914, 0.14746094],
          [0.14575195, 0.18286133, 0.17114258, ..., 0.23376465,
           0.23376465, 0.21398926],
          ...,
          [0.08807373, 0.09771729, 0.09552002, ..., 0.08410645,
           0.13146973, 0.14807129],
          [0.07373047, 0.08428955, 0.09448242, ..., 0.08233643,
           0.49072266, 0.95996094],
          [0.06018066, 0.08428955, 0.09448242, ..., 0.67968750,
           1.21582031, 1.21777344]],

         [[0.        , 0.        , 0.        , ..., 0.46118164,
           0.46118164, 0.58007812],
          [0.        , 0.        , 0.        , ..., 0.53320312,
           0.53320312, 0.45166016],
          [0.        , 0.        , 0.        , ..., 0.53320312,
           0.53320312, 0.52636719],
          ...,
          [0.        , 0.        , 0.        , ..., 0.01530457,
           0.05349731, 0.13049316],
          [0.        , 0.        , 0.        , ..., 0.07330322,
           0.15991211, 0.15991211],
          [0.01910400, 0.03076172, 0.03076172, ..., 0.12670898,
           0.09283447, 0.        ]],

         ...,

         [[0.17163086, 0.23474121, 0.25073242, ..., 1.27441406,
           1.27441406, 1.21777344],
          [0.18383789, 0.23474121, 0.25073242, ..., 0.28979492,
           0.22851562, 0.25292969],
          [0.13159180, 0.15380859, 0.15380859, ..., 0.28979492,
           0.22851562, 0.25292969],
          ...,
          [0.49536133, 0.61474609, 0.87451172, ..., 0.08251953,
           0.11132812, 0.11303711],
          [0.28881836, 0.34204102, 0.49291992, ..., 0.14184570,
           0.11132812, 0.08007812],
          [0.20910645, 0.20910645, 0.23901367, ..., 0.14184570,
           0.75830078, 0.83056641]],

         [[0.33666992, 0.35156250, 0.41601562, ..., 0.28125000,
           0.28125000, 0.11743164],
          [0.33666992, 0.33666992, 0.29345703, ..., 0.38427734,
           0.38427734, 0.23657227],
          [0.28808594, 0.39038086, 0.39038086, ..., 0.16491699,
           0.21252441, 0.23657227],
          ...,
          [0.37304688, 0.37304688, 0.28515625, ..., 0.19152832,
           0.30224609, 0.38574219],
          [0.25292969, 0.22155762, 0.16174316, ..., 0.25732422,
           0.30224609, 0.55224609],
          [0.22973633, 0.19580078, 0.13977051, ..., 0.25732422,
           0.47485352, 0.56494141]],

         [[0.54296875, 0.41088867, 0.34008789, ..., 0.26708984,
           0.15246582, 0.71875000],
          [0.21203613, 0.08666992, 0.12817383, ..., 0.26708984,
           0.31372070, 0.71875000],
          [0.18872070, 0.09716797, 0.16943359, ..., 0.33740234,
           0.34326172, 0.53808594],
          ...,
          [0.        , 0.        , 0.        , ..., 0.16845703,
           0.14636230, 0.52490234],
          [0.01928711, 0.09045410, 0.09594727, ..., 0.29150391,
           1.70410156, 1.70410156],
          [0.76513672, 0.82910156, 0.84326172, ..., 1.04199219,
           1.70410156, 1.70410156]]],


        ...,


        [[[0.49267578, 0.49267578, 0.25073242, ..., 0.28320312,
           0.28271484, 0.77441406],
          [0.24572754, 0.23803711, 0.31225586, ..., 0.17443848,
           0.17443848, 0.77441406],
          [0.64599609, 0.30883789, 0.30883789, ..., 0.13403320,
           0.13427734, 0.78857422],
          ...,
          [0.18432617, 0.08544922, 0.10266113, ..., 0.54785156,
           0.33325195, 0.76318359],
          [0.23132324, 0.10772705, 0.10772705, ..., 0.13488770,
           0.17004395, 0.76318359],
          [0.41308594, 0.18908691, 0.18908691, ..., 0.11553955,
           0.09997559, 0.07904053]],

         [[0.33666992, 0.39013672, 0.56884766, ..., 0.04220581,
           0.02554321, 0.05554199],
          [0.70458984, 0.70458984, 0.56884766, ..., 0.08093262,
           0.09423828, 0.09613037],
          [0.87060547, 1.13183594, 1.13183594, ..., 0.09039307,
           0.08447266, 0.08929443],
          ...,
          [0.16931152, 0.20947266, 0.20947266, ..., 0.68554688,
           0.64697266, 0.42309570],
          [0.17626953, 0.21545410, 0.22290039, ..., 0.62939453,
           0.65820312, 0.68310547],
          [0.93798828, 0.97607422, 0.99951172, ..., 0.62207031,
           0.57958984, 0.55908203]],

         [[0.38305664, 0.20483398, 0.        , ..., 0.11614990,
           0.09399414, 0.07653809],
          [0.        , 0.        , 0.        , ..., 0.06866455,
           0.05291748, 0.03952026],
          [0.        , 0.        , 0.11181641, ..., 0.04678345,
           0.04446411, 0.03747559],
          ...,
          [0.        , 0.        , 0.        , ..., 0.29174805,
           0.19018555, 0.26904297],
          [0.        , 0.        , 0.        , ..., 0.05728149,
           0.19018555, 0.26904297],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ]],

         ...,

         [[0.14941406, 0.00347519, 0.        , ..., 0.89843750,
           0.87792969, 0.87695312],
          [0.00603104, 0.11334229, 0.11334229, ..., 0.14721680,
           0.14721680, 0.14379883],
          [1.30664062, 1.30664062, 1.16210938, ..., 0.10070801,
           0.10504150, 0.16894531],
          ...,
          [0.10083008, 0.10614014, 0.10614014, ..., 0.56005859,
           0.62011719, 0.67724609],
          [0.03344727, 0.00128555, 0.        , ..., 0.04522705,
           0.08825684, 0.27026367],
          [0.47021484, 0.47021484, 0.45898438, ..., 0.16687012,
           0.15429688, 0.09588623]],

         [[0.        , 0.        , 0.19848633, ..., 0.14501953,
           0.15783691, 0.16992188],
          [0.47875977, 0.54589844, 0.52734375, ..., 0.17871094,
           0.20874023, 0.21362305],
          [1.50000000, 1.61523438, 1.37109375, ..., 0.21789551,
           0.20874023, 0.21667480],
          ...,
          [0.31274414, 0.33154297, 0.33105469, ..., 0.66064453,
           0.81884766, 0.82666016],
          [0.30419922, 0.33837891, 0.33837891, ..., 0.62646484,
           0.48681641, 0.50927734],
          [0.40258789, 0.41308594, 0.41552734, ..., 0.31103516,
           0.41552734, 0.50927734]],

         [[1.65136719, 1.65136719, 1.17382812, ..., 0.14416504,
           0.14416504, 0.35839844],
          [1.65136719, 1.65136719, 1.17382812, ..., 0.18493652,
           0.18481445, 0.35839844],
          [0.57226562, 0.17224121, 0.04174805, ..., 0.18261719,
           0.17077637, 0.27294922],
          ...,
          [0.33593750, 0.18774414, 0.27685547, ..., 0.83935547,
           0.55175781, 0.31860352],
          [0.37988281, 0.27197266, 0.30737305, ..., 0.83935547,
           0.62792969, 0.70410156],
          [0.37988281, 0.21813965, 0.22814941, ..., 0.18688965,
           0.21582031, 0.27001953]]],


        [[[0.09558105, 0.38427734, 0.38427734, ..., 0.67724609,
           0.22888184, 0.19079590],
          [0.28540039, 0.28540039, 0.29589844, ..., 0.54980469,
           0.29809570, 0.42822266],
          [0.28540039, 0.29003906, 0.30688477, ..., 0.50830078,
           0.29809570, 0.82568359],
          ...,
          [0.47412109, 0.47412109, 0.44580078, ..., 0.17565918,
           0.17565918, 0.13769531],
          [0.11010742, 0.23107910, 0.23107910, ..., 0.13916016,
           0.13916016, 0.13769531],
          [0.27368164, 0.23107910, 0.23107910, ..., 0.14440918,
           0.17944336, 0.20227051]],

         [[1.13476562, 1.21582031, 1.05761719, ..., 0.90380859,
           1.12304688, 1.13964844],
          [1.13476562, 1.21582031, 1.05761719, ..., 1.23144531,
           0.97900391, 0.52539062],
          [0.19860840, 0.32568359, 0.43701172, ..., 0.04888916,
           0.08874512, 0.09948730],
          ...,
          [0.88232422, 1.19238281, 1.19238281, ..., 0.16381836,
           0.21154785, 0.21154785],
          [0.88232422, 1.19238281, 1.19238281, ..., 0.18811035,
           0.20532227, 0.18957520],
          [0.73388672, 0.86425781, 0.86425781, ..., 0.26806641,
           0.26708984, 0.22424316]],

         [[0.01821899, 0.20544434, 0.09576416, ..., 0.06896973,
           0.        , 0.        ],
          [0.12927246, 0.        , 0.03076172, ..., 0.02551270,
           0.03454590, 0.03454590],
          [0.12927246, 0.00408173, 0.        , ..., 0.06835938,
           0.09924316, 0.09924316],
          ...,
          [0.15380859, 0.29174805, 0.25634766, ..., 0.        ,
           0.        , 0.        ],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ],
          [0.        , 0.        , 0.        , ..., 0.        ,
           0.        , 0.        ]],

         ...,

         [[0.00663757, 0.01756287, 0.17749023, ..., 0.45556641,
           0.66064453, 0.71582031],
          [0.64794922, 0.64794922, 0.59619141, ..., 1.16796875,
           1.16894531, 1.07031250],
          [0.11395264, 0.11395264, 0.        , ..., 1.16796875,
           1.16894531, 1.05566406],
          ...,
          [0.60546875, 0.61914062, 0.53222656, ..., 0.15405273,
           0.16650391, 0.14611816],
          [0.16613770, 0.18127441, 0.17822266, ..., 0.09747314,
           0.11206055, 0.10253906],
          [0.24914551, 0.19299316, 0.25976562, ..., 0.11480713,
           0.14819336, 0.14819336]],

         [[0.20483398, 0.58593750, 1.28710938, ..., 0.46972656,
           0.46972656, 0.58007812],
          [0.51855469, 0.58593750, 1.28710938, ..., 1.03515625,
           0.78857422, 0.65039062],
          [0.20251465, 0.20251465, 0.12731934, ..., 0.75781250,
           0.58935547, 0.44458008],
          ...,
          [1.14160156, 1.14160156, 1.26269531, ..., 0.31054688,
           0.31054688, 0.30859375],
          [0.96972656, 0.96972656, 0.92578125, ..., 0.29248047,
           0.26196289, 0.27197266],
          [0.34521484, 0.37133789, 0.31713867, ..., 0.30102539,
           0.35424805, 0.35424805]],

         [[0.25122070, 0.38818359, 0.38818359, ..., 0.76074219,
           0.74902344, 0.62890625],
          [0.18615723, 0.33911133, 0.47412109, ..., 0.76074219,
           0.        , 0.        ],
          [1.04101562, 1.04101562, 0.98925781, ..., 0.09588623,
           0.05868530, 0.25732422],
          ...,
          [0.71875000, 0.88330078, 0.88330078, ..., 0.13830566,
           0.12261963, 0.13867188],
          [0.71875000, 0.88330078, 0.88330078, ..., 0.15002441,
           0.18688965, 0.18688965],
          [0.20300293, 0.23876953, 0.23876953, ..., 0.14916992,
           0.16357422, 0.13842773]]],


        [[[0.41967773, 0.41967773, 1.55371094, ..., 0.27368164,
           0.20507812, 1.00195312],
          [0.79833984, 1.06933594, 1.55371094, ..., 0.22802734,
           0.20080566, 1.09765625],
          [0.43750000, 1.06933594, 0.64550781, ..., 0.13342285,
           0.16174316, 1.10937500],
          ...,
          [0.12316895, 0.32250977, 0.47363281, ..., 0.81542969,
           1.19921875, 0.79052734],
          [0.16503906, 0.12091064, 0.30419922, ..., 1.15527344,
           1.15527344, 0.16540527],
          [0.38671875, 0.14831543, 0.22070312, ..., 1.25292969,
           1.02636719, 0.11987305]],

         [[0.89648438, 1.07617188, 0.67871094, ..., 0.        ,
           0.        , 0.        ],
          [0.89648438, 1.07617188, 0.67871094, ..., 0.03762817,
           0.04696655, 0.11956787],
          [0.63525391, 0.75048828, 0.62451172, ..., 0.03762817,
           0.05480957, 0.07299805],
          ...,
          [0.79296875, 0.82763672, 0.66650391, ..., 0.09765625,
           0.13439941, 0.13916016],
          [0.18542480, 0.34545898, 0.66650391, ..., 0.12719727,
           0.13439941, 0.13916016],
          [0.94531250, 1.01757812, 1.06542969, ..., 0.16357422,
           0.30810547, 0.30810547]],

         [[0.        , 0.        , 0.06896973, ..., 0.06719971,
           0.07592773, 0.11853027],
          [0.07476807, 0.14648438, 0.04620361, ..., 0.12695312,
           0.12988281, 0.13342285],
          [0.07476807, 0.14648438, 0.05905151, ..., 0.14538574,
           0.17358398, 0.17358398],
          ...,
          [0.08789062, 0.15063477, 0.15063477, ..., 0.49365234,
           0.49365234, 0.        ],
          [0.        , 0.        , 0.        , ..., 0.51611328,
           0.47729492, 0.        ],
          [0.        , 0.        , 0.        , ..., 0.48095703,
           0.        , 0.        ]],

         ...,

         [[0.06640625, 0.        , 0.43774414, ..., 0.82324219,
           0.86962891, 0.92431641],
          [0.64501953, 0.72949219, 0.10821533, ..., 0.58544922,
           0.58544922, 0.51123047],
          [0.82812500, 0.96923828, 1.33789062, ..., 0.15905762,
           0.18798828, 0.22631836],
          ...,
          [0.        , 0.05072021, 0.17004395, ..., 0.33959961,
           0.22106934, 0.08624268],
          [0.        , 0.        , 0.09796143, ..., 0.38183594,
           0.05157471, 0.08624268],
          [0.47631836, 0.47631836, 0.47729492, ..., 0.31640625,
           0.06329346, 0.07470703]],

         [[0.47265625, 0.47265625, 0.40966797, ..., 0.56347656,
           0.56347656, 0.52148438],
          [0.76855469, 1.17285156, 0.95214844, ..., 0.22692871,
           0.18054199, 0.22167969],
          [0.62011719, 0.85839844, 0.91796875, ..., 0.17028809,
           0.18054199, 0.22167969],
          ...,
          [0.41943359, 0.54931641, 0.61230469, ..., 0.32226562,
           0.24902344, 0.27514648],
          [0.38867188, 0.54931641, 0.61230469, ..., 0.40161133,
           0.22875977, 0.26782227],
          [0.36450195, 0.41064453, 0.44360352, ..., 0.22851562,
           0.28979492, 0.29931641]],

         [[0.76269531, 0.83593750, 0.59960938, ..., 0.        ,
           0.        , 0.23840332],
          [0.20227051, 0.22656250, 1.02929688, ..., 0.08782959,
           0.07678223, 0.31372070],
          [0.36181641, 0.37548828, 0.64013672, ..., 0.19433594,
           0.25756836, 0.46801758],
          ...,
          [0.77929688, 0.81738281, 0.93896484, ..., 0.46826172,
           1.03906250, 0.90917969],
          [0.40380859, 0.40283203, 0.52587891, ..., 1.04199219,
           1.04199219, 0.43530273],
          [0.40380859, 0.26611328, 0.29248047, ..., 1.14648438,
           1.04199219, 0.14904785]]]])
NCHW
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 355, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 159, in forward
    shifts = F.temporal_shift(inputs,
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/functional/extension.py", line 300, in temporal_shift
    return _C_ops.temporal_shift(x, seg_num, shift_ratio, data_format)
RuntimeError: (NotFound) The kernel with key (sdaa, Undefined(AnyLayout), float16) of kernel `temporal_shift` is not registered and fail to fallback to CPU one. Selected wrong Backend `sdaa`. Paddle support following Backends: CPU.
  [Hint: Expected kernel_iter != iter->second.end(), but received kernel_iter == iter->second.end().] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/kernel_factory.cc:333)

I0214 14:12:01.902714 2161701 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:12:01.902787 2161701 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:12:02.004774 2161701 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:12:02.007162 2161701 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:12:02.007280 2161701 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:12:02.007304 2161701 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:12:02.661882 2161701 tcp_utils.cc:107] Retry to connect to 172.17.0.3:51969 while the server is not yet listening.
I0214 14:12:05.662266 2161701 tcp_utils.cc:130] Successfully connected to 172.17.0.3:51969
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
=======inputs <class 'paddle.Tensor'>
NCHW
Traceback (most recent call last):
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 142, in <module>
    main()
  File "/root/cas/tww/PaddleVideo_tsm/main.py", line 130, in main
    train_model(cfg,
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/tasks/train.py", line 276, in train_model
    outputs = model(data, mode="train")
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/distributed/parallel.py", line 528, in forward
    outputs = self._layers(*inputs, **kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/base.py", line 49, in forward
    return self.train_step(data_batch)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 48, in train_step
    cls_score = self.forward_net(imgs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/framework/recognizers/recognizer2d.py", line 32, in forward_net
    feature = self.backbone(imgs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 355, in forward
    y = block(y)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1429, in __call__
    return self.forward(*inputs, **kwargs)
  File "/root/cas/tww/PaddleVideo_tsm/paddlevideo/modeling/backbones/resnet_tsm.py", line 159, in forward
    shifts = F.temporal_shift(inputs,
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/functional/extension.py", line 300, in temporal_shift
    return _C_ops.temporal_shift(x, seg_num, shift_ratio, data_format)
RuntimeError: (NotFound) The kernel with key (sdaa, Undefined(AnyLayout), float16) of kernel `temporal_shift` is not registered and fail to fallback to CPU one. Selected wrong Backend `sdaa`. Paddle support following Backends: CPU.
  [Hint: Expected kernel_iter != iter->second.end(), but received kernel_iter == iter->second.end().] (at /root/workspace/paddlepaddle-build/usertestdir_247/paddle/phi/core/kernel_factory.cc:333)

I0214 14:12:47.783064 2163552 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:12:47.783172 2163552 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:12:47.892350 2163552 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:12:47.894973 2163552 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:12:47.895109 2163552 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:12:47.895139 2163552 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:12:48.646796 2163552 tcp_utils.cc:130] Successfully connected to 172.17.0.3:36544
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
I0214 14:13:58.721508 2167513 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:13:58.721549 2167513 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:13:58.807438 2167513 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:13:58.810111 2167513 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:13:58.810233 2167513 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:13:58.810253 2167513 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:13:59.573992 2167513 tcp_utils.cc:107] Retry to connect to 172.17.0.3:46153 while the server is not yet listening.
I0214 14:14:02.574368 2167513 tcp_utils.cc:130] Successfully connected to 172.17.0.3:46153
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/nn/layer/norm.py:824: UserWarning: When training, we now always track global mean and variance.
  warnings.warn(
Exception in thread Thread-1 (_thread_loop):
Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 692, in _get_data
    data = self._data_queue.get(timeout=self._timeout)
  File "/root/miniconda3/envs/tsn/lib/python3.10/multiprocessing/queues.py", line 114, in get
    raise Empty
_queue.Empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    batch = self._get_data()
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 707, in _get_data
    raise RuntimeError(
RuntimeError: DataLoader 4 workers exit unexpectedly, pids: 2168947, 2168955, 2168963, 2168971
I0214 14:16:35.476352 2172611 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:16:35.476424 2172611 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:16:35.580538 2172611 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:16:35.583842 2172611 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:16:35.583986 2172611 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:16:35.584015 2172611 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:16:36.447314 2172611 tcp_utils.cc:107] Retry to connect to 172.17.0.3:52318 while the server is not yet listening.
I0214 14:16:39.447746 2172611 tcp_utils.cc:130] Successfully connected to 172.17.0.3:52318
Exception in thread Thread-1 (_thread_loop):
Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 692, in _get_data
    data = self._data_queue.get(timeout=self._timeout)
  File "/root/miniconda3/envs/tsn/lib/python3.10/multiprocessing/queues.py", line 114, in get
    raise Empty
_queue.Empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    batch = self._get_data()
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 707, in _get_data
    raise RuntimeError(
RuntimeError: DataLoader 4 workers exit unexpectedly, pids: 2174043, 2174049, 2174057, 2174074
I0214 14:38:14.202629 2206121 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0214 14:38:14.202687 2206121 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0214 14:38:14.281697 2206121 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0214 14:38:14.283597 2206121 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0214 14:38:14.283689 2206121 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0214 14:38:14.283706 2206121 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0214 14:38:15.000103 2206121 tcp_utils.cc:130] Successfully connected to 172.17.0.3:42241
Found inf or nan, current scale is: 65536.0, decrease to: 65536.0*0.5
Exception in thread Thread-1 (_thread_loop):
Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 692, in _get_data
    data = self._data_queue.get(timeout=self._timeout)
  File "/root/miniconda3/envs/tsn/lib/python3.10/multiprocessing/queues.py", line 114, in get
    raise Empty
_queue.Empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/root/miniconda3/envs/tsn/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    batch = self._get_data()
  File "/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 707, in _get_data
    raise RuntimeError(
RuntimeError: DataLoader 4 workers exit unexpectedly, pids: 2207483, 2207491, 2207499, 2207505
I0215 10:31:27.466636 3900260 init.cc:233] ENV [CUSTOM_DEVICE_ROOT]=/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device
I0215 10:31:27.466696 3900260 init.cc:142] Try loading custom device libs from: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
sdaa plugin compiled with gcc
PaddlePaddle Compilation Commit: e5b01458d31bab831dbd96a53522bf207b2fcd9e
PaddlePaddle Compilation Version: 2.6.0
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
|         | paddle | paddle_commit | sdaa_runtime | sdaa_driver | teco_dnn | teco_blas | teco_tccl | teco_custom | sdpti | paddle_sdaa_version | paddle_sdaa_commit |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
| Version | 2.6.0  | e5b0145       | 1.3.1        | 1.3.1       | 2.0.0b0  | 2.0.0b0   | 1.20.0    | 1.22.0      | 1.3.0 | 1.3.1               | 9671916            |
+---------+--------+---------------+--------------+-------------+----------+-----------+-----------+-------------+-------+---------------------+--------------------+
+--------------------------+---------------+---------------+
| Variable Name            | Default Value | Current Value |
+--------------------------+---------------+---------------+
| CUSTOM_DEVICE_BLACK_LIST |               |               |
+--------------------------+---------------+---------------+
| ENABLE_SDPTI             | 1             | 1             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_CONV    | 0             | 0             |
+--------------------------+---------------+---------------+
| HIGH_PERFORMANCE_GEMM    | 0             | 0             |
+--------------------------+---------------+---------------+
| RANDOM_ALIGN_NV_DEVICE   |               |               |
+--------------------------+---------------+---------------+
| PADDLE_XCCL_BACKEND      |               | sdaa          |
+--------------------------+---------------+---------------+
| HIGH_PRECISION_OP_LIST   |               |               |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_reuse_event   | true          | true          |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_runtime_debug | false         | false         |
+--------------------------+---------------+---------------+
| FLAGS_sdaa_matmul_scale  | 1.0           | 1.0           |
+--------------------------+---------------+---------------+
| DUMP_INTO_PROFILER       | 0             | 0             |
+--------------------------+---------------+---------------+
I0215 10:31:27.636356 3900260 custom_device.cc:1109] Successed in loading custom runtime in lib: /root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device/libpaddle-sdaa.so
I0215 10:31:27.638706 3900260 custom_kernel.cc:63] Successed in loading 271 custom kernel(s) from loaded lib(s), will be used like native ones.
I0215 10:31:27.638805 3900260 init.cc:154] Finished in LoadCustomDevice with libs_path: [/root/miniconda3/envs/tsn/lib/python3.10/site-packages/paddle_custom_device]
I0215 10:31:27.638830 3900260 init.cc:239] CustomDevice: sdaa, visible devices count: 1
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'SimpleITK', [SimpleITK] package and it's dependencies is required for PP-Care.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
Warning! No module named 'lmdb', [lmdb] package and it's dependencies is required for ActBERT.
Warning! No module named 'paddlenlp', [paddlenlp] package and it's dependencies is required for ActBERT.
I0215 10:31:28.683225 3900260 tcp_utils.cc:107] Retry to connect to 172.17.0.3:51452 while the server is not yet listening.
I0215 10:31:31.683431 3900260 tcp_utils.cc:130] Successfully connected to 172.17.0.3:51452
